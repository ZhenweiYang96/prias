% !TEX root =  ../supplementary.tex
\section{Source Code}
The R code for fitting the joint model to the PRIAS dataset, is at \url{https://github.com/anirudhtomer/prias/tree/master/src/clinical_gap3}. We refer to this location as `R\_HOME' in the rest of this document.

\subsection{Fitting the Joint Model to the PRIAS dataset}
\textbf{Accessing the dataset:}
The PRIAS dataset is not openly accessible. However, access to the database can be requested via the contact links at \url{https://www.prias-project.org}.\\

\textbf{Formatting the dataset:}
This dataset, however, is in the so-called wide format and also requires the removal of incorrect entries. This can be done via the R script \url{R_HOME/dataset_cleaning.R}. This will lead to two R objects, namely `prias\_final.id' and `prias\_long\_final'. The `prias\_final.id' object contains information about the time of upgrading for PRIAS patients. The `prias\_long\_final' object contains longitudinal PSA measurements, the time of biopsies and results of biopsies.\\

\textbf{Fitting the joint model:}
We use a joint model for time-to-event and longitudinal data to model the evolution of PSA measurements over time, and to simultaneously model their association with the risk of upgrading. The R package we use for this purpose is called \textbf{JMbayes} (https://cran.r-project.org/web/packages/JMbayes/JMbayes.pdf). The API we use, however, is currently not hosted on CRAN, and can be found here:
\url{https://github.com/anirudhtomer/JMbayes}. The joint model can be fitted via the script \url{R_HOME/analysis.R}. It takes roughly 6 hours to run on an Intel Core-i5 machine with four cores and 8GB of RAM. 

The graphs presented in the main manuscript, and the supplementary material can be generated by the scripts in \url{R_HOME/plots/}.

\subsection{Validation of Predictions of Upgrading}
Validations can be done using the scripts \url{R_HOME/validation/auc_brier/auc_calculator.R}, and \url{R_HOME/validation/auc_brier/gof_calculator.R}. For external validation access to GAP3 database is required.

\subsection{Creating Personalized Schedules of Biopsies}
Once a joint model is fitted to the PRIAS dataset, personalized schedules of biopsies based on the risk of upgrading for new patients can be developed as shown in the script \url{R_HOME/plots/demo_schedule_supplementary.R} or directly using the script \url{https://raw.githubusercontent.com/anirudhtomer/prias/master/src/lastpaper/pers_schedule_api.R}.

\subsection{Source Code for Web Application}
Source code for the shiny web application which provides biopsy schedules for patients can be found at \url{R_HOME/shinyapp}