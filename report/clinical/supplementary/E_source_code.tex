% !TEX root =  ../supplementary.tex
\section{Source Code}
The R code for fitting the joint model to the PRIAS dataset, is at \url{https://github.com/anirudhtomer/prias/tree/master/src/clinical_gap3}. We refer to this location as `R\_HOME' in the rest of this document.

\subsection{Fitting the Joint Model to the PRIAS dataset}
\textbf{Accessing the dataset:}
The PRIAS dataset is not openly accessible. However, access to the database can be requested via the contact links at \url{www.prias-project.org}.\\

\textbf{Formatting the dataset:}
This dataset however is in the so-called wide format and also requires removal of incorrect entries. This can be done via the R script \url{R_HOME/dataset_cleaning.R}. This will lead to two R objects, namely `prias\_final.id' and `prias\_long\_final'. The `prias\_final.id' object contains information about time of reclassification for PRIAS patients. The `prias\_long\_final' object contains longitudinal PSA measurements, the time of biopsies and results of biopsies.\\

\textbf{Fitting the joint model:}
We use a joint model for time to event and longitudinal data to model the evolution of PSA measurements over time, and to simultaneously model their association with the risk of reclassification. The R package we use for this purpose is called \textbf{JMbayes} (https://cran.r-project.org/web/packages/JMbayes/JMbayes.pdf). The API we use, however, are currently not hosted on CRAN, and can be found here:
\url{https://github.com/anirudhtomer/JMbayes}. The joint model can be fitted via the script \url{R_HOME/analysis.R}. It takes roughly 6 hours to run on an Intel core-i5 machine with 4 cores, and 8GB of RAM. 

The graphs presented in the main manuscript, and the supplementary material can be generated by the scripts in \url{R_HOME/plots/}.

\subsection{Validation of Predictions of Reclassification}
Validations can be done using the scripts \url{R_HOME/validation/auc_brier/auc_calculator.R}, and \url{R_HOME/validation/auc_brier/gof_calculator.R}. For external validation access to GAP3 database is required.

\subsection{Creating Personalized Schedules of Biopsies}
Once a joint model is fitted to the PRIAS dataset, personalized schedules of biopsies based on risk of reclassification for new patients can be developed using the script \url{R_HOME/scheduleCreator.R}. This script also provides fixed biopsy schedules for the patients. In addition with each schedule, the expected delay in detection of reclassification is also provided.

\subsection{Source Code for Web Application}
Source for the shiny web application which provides biopsy schedules for patients can be found at \url{R_HOME/shinyapp}
